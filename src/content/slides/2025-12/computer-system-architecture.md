---
title: "计算机系统架构入门"
author: "foxgem"
description: "从 CPU 到内存，理解计算机系统的核心组成与工作原理。"
pubDate: 2025-12-02
tags: ["computer-science", "architecture", "cpu", "memory"]
theme: "league"
transition: "zoom"
controls: true
progress: true
---

## 计算机系统架构入门

理解计算机如何工作

---

## 冯·诺依曼架构

```
┌─────────────────────────────────────┐
│              CPU                    │
│  ┌─────────┐    ┌─────────────┐    │
│  │ 控制器  │    │  运算器     │    │
│  └─────────┘    └─────────────┘    │
└───────────────────┬─────────────────┘
                    │ 总线
┌───────────────────┴─────────────────┐
│            主存储器                  │
│    (存储程序和数据)                  │
└───────────────────┬─────────────────┘
                    │
         ┌──────────┴──────────┐
         │                     │
    ┌────┴────┐          ┌────┴────┐
    │ 输入设备 │          │ 输出设备 │
    └─────────┘          └─────────┘
```

---

## CPU 核心概念

- **时钟频率**: 每秒执行周期数 (GHz)
- **指令周期**: 取指 → 译码 → 执行 → 写回
- **流水线**: 多条指令并行处理
- **缓存**: L1, L2, L3 多级缓存
- **核心数**: 多核并行计算

---

## 存储层次结构

```
        速度快 ↑          ↑ 价格高
             │ 寄存器    │
             │ L1 Cache  │
             │ L2 Cache  │
             │ L3 Cache  │
             │ 主存 RAM  │
             │ SSD/HDD   │
        容量大 ↓          ↓ 价格低
```

---

## 缓存原理

**局部性原理**

- **时间局部性**: 最近访问的数据可能再次访问
- **空间局部性**: 访问某地址后，可能访问相邻地址

```
缓存命中 (Cache Hit): 直接返回数据
缓存未命中 (Cache Miss): 从下级存储加载
```

---

## 虚拟内存

```
虚拟地址空间          物理内存
┌──────────┐         ┌──────────┐
│  代码段   │  ─────→ │          │
├──────────┤         │  物理页   │
│  数据段   │  ─────→ │          │
├──────────┤         │          │
│   堆     │  ─────→ │          │
│    ↓     │         └──────────┘
│    ↑     │              ↕
│   栈     │         ┌──────────┐
└──────────┘         │ 磁盘交换 │
                     └──────────┘
```

---

## 页表与 TLB

```
虚拟地址 → TLB 查找 → 命中 → 物理地址
              ↓ 未命中
          页表查找 → 物理地址
              ↓ 页不在内存
          缺页中断 → 从磁盘加载
```

---

## 指令集架构 (ISA)

| 类型 | 代表 | 特点 |
|-----|------|------|
| CISC | x86 | 指令复杂，变长 |
| RISC | ARM | 指令简单，定长 |
| RISC-V | RISC-V | 开源，模块化 |

---

## 总线系统

```
CPU ←→ 北桥 ←→ 内存
         ↕
        PCIe ←→ 显卡
         ↕
       南桥 ←→ USB/SATA/网卡
```

现代架构已将北桥集成到 CPU 中

---

## 并发与并行

```
并发 (Concurrency):
  时间片轮转，宏观并行，微观串行
  
  CPU: ─A─B─A─B─A─B─
  
并行 (Parallelism):
  真正同时执行
  
  CPU0: ─A─A─A─
  CPU1: ─B─B─B─
```

---

## 性能优化要点

- 减少内存访问，利用缓存 <!-- .element: class="fragment" -->
- 数据对齐，提高访问效率 <!-- .element: class="fragment" -->
- 避免分支预测失败 <!-- .element: class="fragment" -->
- 利用 SIMD 指令并行计算 <!-- .element: class="fragment" -->
- 合理使用多线程 <!-- .element: class="fragment" -->

---

## 总结

理解计算机系统架构：

1. 冯·诺依曼架构是基础
2. 存储层次结构决定性能
3. 缓存是性能优化的关键
4. 虚拟内存实现内存抽象
5. 现代 CPU 复杂但原理不变

---

## 推荐阅读

- 《深入理解计算机系统》(CSAPP)
- 《计算机组成与设计：硬件/软件接口》
- 《现代操作系统》

